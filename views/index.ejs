<% if (locals.user) { %>
<!-- User is logged in, show todo list -->
<div class="todo-container">
    <div class="sidebar">
        <div class="calendar-section">
            <h2>Calendar</h2>
            <div class="calendar-header">
                <div class="calendar-title" id="calendar-month">
                    August 2023
                </div>
                <div class="calendar-nav">
                    <button id="prev-month">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button id="next-month">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>

            <div id="calendar-days" class="calendar-days">
                <!-- Calendar days will be inserted here by JS -->
            </div>

            <div class="calendar-legend">
                <div class="legend-item">
                    <span class="legend-marker today-marker"></span>
                    <span>Today</span>
                </div>
                <div class="legend-item">
                    <span class="legend-marker selected-marker"></span>
                    <span>Selected</span>
                </div>
                <div class="legend-item">
                    <span class="legend-marker todo-marker"></span>
                    <span>Has Todo Items</span>
                </div>
            </div>

            <button id="today-btn" class="btn btn-block">Today</button>

            <div class="toggle-container">
                <span class="toggle-label">Include shared todos</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="include-shared" />
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="todo-header">
            <h2 class="todo-title" id="current-date">Today's Todos</h2>
            <button id="new-todo-btn" class="btn">
                <i class="fas fa-plus"></i> New Todo
            </button>
        </div>

        <div class="todo-nav">
            <button id="prev-day">
                <i class="fas fa-chevron-left"></i> Previous Day
            </button>
            <button id="next-day">
                Next Day <i class="fas fa-chevron-right"></i>
            </button>
        </div>

        <ul id="todo-list" class="todo-list">
            <!-- Todo items will be inserted here by JS -->
            <li class="loading">Loading todos...</li>
        </ul>
    </div>
</div>

<!-- Todo Modal -->
<div class="modal-overlay">
    <div class="modal">
        <div class="modal-header">
            <h3 id="todo-form-title" class="modal-title">New Todo</h3>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <form id="todo-form">
                <div class="form-group">
                    <label for="todo-title" class="form-label">Title</label>
                    <input
                        type="text"
                        id="todo-title"
                        class="form-control"
                        required
                    />
                </div>
                <div class="form-group">
                    <label for="todo-description" class="form-label"
                        >Description</label
                    >
                    <textarea
                        id="todo-description"
                        class="form-control"
                        rows="3"
                    ></textarea>
                </div>
                <div class="form-group">
                    <label for="todo-date" class="form-label">Due Date</label>
                    <input
                        type="date"
                        id="todo-date"
                        class="form-control"
                        required
                    />
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary modal-close">
                Cancel
            </button>
            <button
                type="submit"
                id="todo-form-submit"
                class="btn"
                form="todo-form"
            >
                Add Todo
            </button>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal-overlay delete-modal-overlay">
    <div class="modal delete-modal">
        <div class="modal-header">
            <h3 class="modal-title">Delete Todo</h3>
            <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <p>Are you sure you want to delete this todo?</p>
            <p>This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary btn-cancel-delete">
                Cancel
            </button>
            <button type="button" class="btn btn-confirm btn-confirm-delete">
                Delete
            </button>
        </div>
    </div>
</div>

<!-- Share Modal -->
<div class="modal-overlay share-modal-overlay">
    <div class="modal">
        <div class="modal-header">
            <h3 class="modal-title">Share with Family</h3>
            <button class="modal-close share-modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <div id="family-list-modal">
                <!-- Family members will be inserted here by JS -->
                <p>Loading family members...</p>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary share-modal-close">
                Cancel
            </button>
            <button type="button" id="save-share-btn" class="btn">
                Save Sharing Settings
            </button>
        </div>
    </div>
</div>

<% /* Include necessary scripts */ %> <%- contentFor('scripts') %>
<script src="/js/todos.js"></script>
<script src="/js/calendar.js"></script>
<script src="/js/family.js"></script>
<% } else { %>
<!-- User is not logged in, show landing page -->
<section class="hero">
    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title">Get organized with Fiks Ferdig</h1>
            <p class="hero-subtitle">
                A simple todo list app to help you manage your daily tasks
            </p>
            <div class="hero-buttons">
                <a href="/sign-up" class="btn">Sign Up</a>
                <a href="/sign-in" class="btn btn-secondary">Log In</a>
            </div>
        </div>
    </div>
</section>

<section class="features">
    <div class="container">
        <h2 class="features-title">Features</h2>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <h3 class="feature-title">Organize by Date</h3>
                <p class="feature-description">
                    Plan your tasks by day and navigate easily between dates
                </p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-users"></i></div>
                <h3 class="feature-title">Family Sharing</h3>
                <p class="feature-description">
                    Share your tasks with family members for better coordination
                </p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h3 class="feature-title">Simple Interface</h3>
                <p class="feature-description">
                    Clean and intuitive design makes managing tasks a breeze
                </p>
            </div>
        </div>
    </div>
</section>
<% } %>
